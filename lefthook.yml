output:
  - success
  - failure

# Match to validate.yml
pre-commit:
  parallel: true
  jobs:
    - name: Build
      glob: "{pkg/*,main.go,go.mod}"
      run: go build

    - name: Lint
      glob: "{*.go,.golangci*}"
      run: golangci-lint run --fix
      stage_fixed: true

    - name: Actions
      glob: ".github/*"
      group:
        parallel: true
        jobs:
          - name: action-validator
            run: >
              find ./.github -type f -mindepth 2 -name "*.yml" -exec
              action-validator --verbose {} +
          - run: actionlint

    - name: ShellCheck
      glob: "{scripts/*,*.sh}"
      run: |
        for file in {staged_files}; do
          (cd "$(dirname "$file")" && shellcheck --color=always -x "$(basename "$file")")
        done

    - name: Docs
      glob: "{docs/*,mkdocs.yml}"
      run: mkdocs build --strict

    - name: Markdown
      glob: "*.md"
      run: npx markdown-link-check --quiet {staged_files} | (! grep .)

    - name: Prettier
      glob: "*{.md,.yml,.json}"
      run: npx --yes prettier --write .
      stage_fixed: true

    - name: EditorConfig
      run: git ls-files -z | npx --yes editorconfig-checker
